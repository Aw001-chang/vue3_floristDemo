{"version":3,"sources":["webpack:///./src/views/Coupons.vue","webpack:///./src/components/CouponModal.vue","webpack:///./src/components/CouponModal.vue?93fb","webpack:///./src/views/Coupons.vue?fdd6"],"names":["class","_createElementVNode","_hoisted_2","type","onClick","$options","_hoisted_5","_createElementBlock","_Fragment","_renderList","$data","item","key","id","_toDisplayString","title","percent","_ctx","date","due_date","is_enabled","_hoisted_9","_hoisted_10","_createVNode","_component_Pagination","pages","onEmitPages","_component_CouponModal","ref","coupon","onUpdateCoupon","_component_DelCoupon","onDeleteItem","tabindex","role","aria-labelledby","aria-hidden","data-bs-dismiss","aria-label","for","_hoisted_4","_hoisted_7","$event","placeholder","code","_hoisted_11","_hoisted_13","true-value","false-value","_hoisted_16","_hoisted_18","props","data","tempCoupon","watch","this","console","log","Math","floor","Date","mixins","modalMixin","__exports__","inject","config","Object","components","CouponModal","Pagination","DelCoupon","coupons","pagination","isNew","methods","openModal","getTime","componentCoupon","$refs","couponModal","showModal","getCoupons","page","api","$http","get","then","res","updateCoupon","post","hideModal","success","emitter","emit","style","content","message","join","put","openDelModal","componentDelModal","delCouponModal","delCoupon","delete","created","render"],"mappings":"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","file":"js/chunk-2d22c48a.1b8b1be6.js","sourcesContent":["<template>\n  <div class=\"container-xl mt-5\">\n    <h1>優惠券</h1>\n    <div class=\"text-end\">\n      <button\n        type=\"button\"\n        class=\"btn btn-primary\"\n        @click=\"openModal(true)\"\n      >新增優惠券\n      </button>\n    </div>\n    <table class=\"table mt-4\">\n      <thead>\n        <tr>\n          <th>名稱</th>\n          <th>折扣百分比</th>\n          <th>到期日</th>\n          <th>是否啟用</th>\n          <th>編輯</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"item in coupons\" :key=\"item.id\">\n          <td>{{ item.title }}</td>\n          <td>{{ item.percent }}%</td>\n          <td>{{ $filters.date(item.due_date) }}</td>\n          <td>\n            <span class=\"text-success\" v-if=\"item.is_enabled === 1\">啟用</span>\n            <span class=\"text-muted\" v-else>未啟用</span>\n          </td>\n          <td>\n            <div class=\"btn-group\">\n              <button\n                class=\"btn btn-outline-primary btn-sm\"\n                @click=\"openModal(false,item)\"\n              >編輯</button>\n              <button\n                class=\"btn btn-outline-danger btn-sm\"\n                @click=\"openDelModal(item)\"\n              >刪除</button>\n            </div>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <Pagination :pages=\"pagination\" @emit-pages=\"getCoupons\"></Pagination>\n  </div>\n  <CouponModal\n    ref=\"couponModal\"\n    :coupon=\"tempCoupon\"\n    @update-coupon=\"updateCoupon\"\n  ></CouponModal>\n  <DelCoupon\n    ref=\"delCouponModal\"\n    :item=\"tempCoupon\"\n    @delete-item=\"delCoupon\"\n  ></DelCoupon>\n</template>\n\n<script>\nimport CouponModal from '../components/CouponModal.vue'\nimport DelCoupon from '../components/DelModal.vue'\nimport Pagination from '../components/Pagination.vue'\nexport default {\n  inject: [\n    'emitter'\n  ],\n  props: {\n    config: Object\n  },\n  components: {\n    CouponModal,\n    Pagination,\n    DelCoupon\n  },\n  data () {\n    return {\n      coupons: {},\n      tempCoupon: {\n        title: '',\n        is_enabled: 0,\n        percent: 100,\n        code: ''\n      },\n      pagination: {},\n      isNew: false\n    }\n  },\n  methods: {\n    openModal (isNew, item) {\n      this.isNew = isNew\n      if (isNew) {\n        this.tempCoupon = {\n          due_date: new Date().getTime() / 1000\n        }\n      } else {\n        this.tempCoupon = { ...item }\n      }\n      const componentCoupon = this.$refs.couponModal\n      componentCoupon.showModal()\n    },\n    getCoupons (page = 1) {\n      const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupons?page=${page}`\n      this.$http.get(api).then((res) => {\n        this.coupons = res.data.coupons\n        this.pagination = res.data.pagination\n      })\n    },\n    updateCoupon (tempCoupon) {\n      const componentCoupon = this.$refs.couponModal\n      if (this.isNew) {\n        const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon`\n        this.$http.post(api, { data: tempCoupon }).then((res) => {\n          componentCoupon.hideModal()\n          if (res.data.success) {\n            this.getCoupons()\n            this.emitter.emit('push-message', {\n              style: 'success',\n              title: '更新成功'\n            })\n          } else {\n            this.emitter.emit('push-message', {\n              style: 'danger',\n              title: '更新失敗',\n              content: res.data.message.join('、')\n            })\n          }\n        })\n      } else {\n        const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon/${tempCoupon.id}`\n        this.$http.put(api, { data: this.tempCoupon }).then((res) => {\n          componentCoupon.hideModal()\n          if (res.data.success) {\n            this.getCoupons()\n            this.emitter.emit('push-message', {\n              style: 'success',\n              title: '更新成功'\n            })\n          } else {\n            this.emitter.emit('push-message', {\n              style: 'danger',\n              title: '更新失敗',\n              content: res.data.message.join('、')\n            })\n          }\n        })\n      }\n    },\n    // 刪除\n    openDelModal (item) {\n      this.tempCoupon = { ...item }\n      const componentDelModal = this.$refs.delCouponModal\n      componentDelModal.showModal()\n    },\n    delCoupon () {\n      const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`\n      this.$http.delete(api).then((res) => {\n        this.$refs.delCouponModal.hideModal()\n        this.getCoupons()\n      })\n    }\n  },\n  created () {\n    this.getCoupons()\n  }\n}\n</script>\n\n<style>\n\n</style>\n","<template>\n  <div class=\"modal fade\" id=\"couponModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\" ref=\"modal\">\n    <div class=\"modal-dialog\" role=\"document\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">優惠券</h5>\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"mb-3\">\n            <label for=\"title\">標題</label>\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              id=\"title\"\n              v-model=\"tempCoupon.title\"\n              placeholder=\"請輸入標題\"\n            >\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"coupon_code\">優惠碼</label>\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              id=\"coupon_code\"\n              v-model=\"tempCoupon.code\"\n              placeholder=\"請輸入優惠碼\"\n            >\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"due_date\">到期日</label>\n            <input\n              type=\"date\"\n              class=\"form-control\"\n              id=\"due_date\"\n              v-model=\"due_date\">\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"price\">折扣百分比</label>\n            <input\n              type=\"number\"\n              class=\"form-control\"\n              id=\"price\"\n              v-model.number=\"tempCoupon.percent\"\n              placeholder=\"請輸入折扣百分比\">\n          </div>\n          <div class=\"mb-3\">\n            <div class=\"form-check\">\n              <input\n                class=\"form-check-input\"\n                type=\"checkbox\"\n                :true-value=\"1\"\n                :false-value=\"0\"\n                v-model=\"tempCoupon.is_enabled\"\n                id=\"is_enabled\"\n              >\n              <label class=\"form-check-label\" for=\"is_enabled\">\n                是否啟用\n              </label>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\n          <button\n            type=\"button\"\n            class=\"btn btn-primary\"\n            @click=\"$emit('update-coupon', tempCoupon)\"\n          >更新優惠券\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport modalMixin from '@/mixins/modalMixins'\nexport default {\n  props: {\n    coupon: {}\n  },\n  data () {\n    return {\n      tempCoupon: {},\n      due_date: ''\n    }\n  },\n  watch: {\n    coupon () {\n      this.tempCoupon = this.coupon\n      // 將時間格式改為 YYYY-MM-DD\n      console.log(this.tempCoupon.due_date)\n      // const dateAndTime = new Date(this.tempCoupon.due_date * 1000).toISOString().split('T')\n      // this.due_date = dateAndTime\n    },\n    due_date () {\n      this.tempCoupon.due_date = Math.floor(new Date(this.due_date) / 1000)\n    }\n  },\n  mixins: [\n    modalMixin\n  ]\n}\n</script>\n","import { render } from \"./CouponModal.vue?vue&type=template&id=076b2b65\"\nimport script from \"./CouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./CouponModal.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/macintosh/Documents/vue3_2022/diving/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Coupons.vue?vue&type=template&id=1f4b92b3\"\nimport script from \"./Coupons.vue?vue&type=script&lang=js\"\nexport * from \"./Coupons.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/macintosh/Documents/vue3_2022/diving/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}