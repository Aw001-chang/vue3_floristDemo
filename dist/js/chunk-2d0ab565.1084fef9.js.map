{"version":3,"sources":["webpack:///./src/views/Orders.vue","webpack:///./src/components/OrderModal.vue","webpack:///./src/components/OrderModal.vue?c6ef","webpack:///./src/views/Orders.vue?92e5"],"names":["class","_createElementVNode","_createVNode","_component_Loading","active","$data","_hoisted_2","_hoisted_4","_createElementBlock","_Fragment","_renderList","item","key","id","_toDisplayString","_ctx","date","create_at","user","email","products","product","title","qty","unit","currency","total","type","is_paid","$event","onChange","$options","for","_hoisted_8","_hoisted_9","onClick","_hoisted_11","_hoisted_12","_component_Pagination","pages","onEmitPages","_component_OrderModal","ref","order","onUpdateOrder","_component_delModal","onDeleteItem","tabindex","aria-labelledby","aria-hidden","role","data-bs-dismiss","aria-label","_hoisted_10","name","_hoisted_13","tel","_hoisted_14","address","_hoisted_16","_hoisted_18","_hoisted_19","_hoisted_20","paid_date","_hoisted_21","_hoisted_24","_hoisted_25","_hoisted_28","props","Object","default","data","modal","tempOrder","isPaid","watch","this","mixins","modalMixin","__exports__","inject","isLoading","orders","pagination","components","OrderModal","delModal","Pagination","methods","openOrderModal","orderConponent","$refs","orderModal","showModal","getOrders","page","api","$http","get","then","res","updatePaid","paid","put","hideModal","currentPage","emitter","emit","style","openDelModal","deleteOrder","delete","console","log","delComponent","$emitter","created","render"],"mappings":"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","file":"js/chunk-2d0ab565.1084fef9.js","sourcesContent":["<template>\n  <Loading :active=\"isLoading\"></Loading>\n  <div class=\"container-xl mt-5\">\n    <h1>訂單</h1>\n    <table class=\"table mt-4\">\n      <thead>\n        <tr>\n          <th>購買時間</th>\n          <th>Email</th>\n          <th>購買款項</th>\n          <th>應付金額</th>\n          <th>是否付款</th>\n          <th>編輯</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"item in orders\" :key=\"item.id\">\n          <td>{{ $filters.date(item.create_at) }}</td>\n          <td>{{ item.user.email }}</td>\n          <td>\n            <ul>\n              <li v-for=\"product in item.products\" :key=\"product.id\">\n                {{ product.product.title }}, 數量：{{ product.qty }}\n                {{ product.product.unit }}\n              </li>\n            </ul>\n          </td>\n          <td>{{ $filters.currency(item.total) }}</td>\n          <td>\n            <div class=\"form-check form-switch\">\n              <input\n                class=\"form-check-input\"\n                type=\"checkbox\"\n                :id=\"`paidSwitch$(item.id)`\"\n                v-model=\"item.is_paid\"\n                @change=\"updatePaid(item)\"\n              >\n              <label class=\"form-check-label\" :for=\"`paidSwitch$(item.id)`\">\n                <span v-if=\"item.is_paid\">已付款</span>\n                <span v-else>未付款</span>\n              </label>\n            </div>\n          </td>\n          <td>\n            <div class=\"btn-group\">\n              <button\n                class=\"btn btn-outline-primary btn-sm\"\n                @click=\"openOrderModal(item)\"\n              >檢視</button>\n              <button\n                class=\"btn btn-outline-danger btn-sm\"\n                @click=\"openDelModal(item)\"\n              >刪除</button>\n            </div>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <Pagination :pages=\"pagination\" @emit-pages=\"getOrders\"></Pagination>\n  </div>\n  <OrderModal\n    ref=\"orderModal\"\n    :order=\"tempOrder\"\n    @update-order=\"updatePaid\"\n  ></OrderModal>\n  <delModal\n    ref=\"delModal\"\n    :item=\"tempOrder\"\n    @delete-item=\"deleteOrder\"\n  ></delModal>\n</template>\n\n<script>\nimport OrderModal from '../components/OrderModal.vue'\nimport delModal from '../components/DelModal.vue'\nimport Pagination from '../components/Pagination.vue'\nexport default {\n  inject: [\n    'emitter'\n  ],\n  data () {\n    return {\n      isLoading: false,\n      orders: {},\n      pagination: {},\n      tempOrder: {}\n    }\n  },\n  components: {\n    OrderModal,\n    delModal,\n    Pagination\n  },\n  methods: {\n    openOrderModal (item) {\n      this.tempOrder = { ...item }\n      const orderConponent = this.$refs.orderModal\n      orderConponent.showModal()\n    },\n    getOrders (page = 1) {\n      this.isLoading = true\n      const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/orders?page=${page}`\n      this.$http.get(api).then((res) => {\n        this.isLoading = false\n        this.orders = res.data.orders\n        this.pagination = res.data.pagination\n      })\n    },\n    updatePaid (item) {\n      this.isLoading = true\n      this.tempOrder = item\n      const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/order/${item.id}`\n      const paid = {\n        is_paid: item.is_paid\n      }\n      const orderConponent = this.$refs.orderModal\n      this.$http.put(api, { data: paid }).then((res) => {\n        orderConponent.hideModal()\n        this.isLoading = false\n        this.getOrders(this.currentPage)\n        this.emitter.emit('push-message', {\n          style: 'success',\n          title: '更新付款狀態'\n        })\n      })\n    },\n    // 刪除\n    openDelModal (item) {\n      this.tempOrder = { ...item }\n      const orderConponent = this.$refs.delModal\n      orderConponent.showModal()\n    },\n    deleteOrder () {\n      const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/order/${this.tempOrder.id}`\n      this.$http.delete(api).then((res) => {\n        console.log(res.data)\n        const delComponent = this.$refs.delModal\n        delComponent.hideModal()\n        this.getOrders()\n        this.$emitter.emit('push-message', {\n          style: 'success',\n          title: '刪除訂單成功'\n        })\n      })\n    }\n  },\n  created () {\n    this.getOrders()\n  }\n}\n</script>\n\n<style>\n\n</style>\n","<template>\n  <div class=\"modal fade\" id=\"exampleModal\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\" ref=\"modal\">\n    <div class=\"modal-dialog modal-xl\" role=\"document\">\n      <div class=\"modal-content border-0\">\n        <div class=\"modal-header bg-dark text-white\">\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">\n            <span>訂單細節</span>\n          </h5>\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"row\">\n            <div class=\"col-sm-4\">\n              <div class=\"fs-4 mb-3 fw-bold\">用戶資料</div>\n              <table class=\"table\">\n                <tbody v-if=\"tempOrder.user\">\n                  <tr>\n                    <th>姓名</th>\n                    <td>{{ tempOrder.user.name }}</td>\n                  </tr>\n                  <tr>\n                    <th>Email</th>\n                    <td>{{ tempOrder.user.email }}</td>\n                  </tr>\n                  <tr>\n                    <th>電話</th>\n                    <td>{{ tempOrder.user.tel }}</td>\n                  </tr>\n                  <tr>\n                    <th>地址</th>\n                    <td>{{ tempOrder.user.address }}</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n            <div class=\"col-sm-8\">\n              <div class=\"fs-4 mb-3 fw-bold\">訂單細節</div>\n              <table class=\"table\">\n                <tbody>\n                  <tr>\n                    <th>訂單編號</th>\n                    <td>{{tempOrder.id}}</td>\n                  </tr>\n                  <tr>\n                    <th>下單時間</th>\n                    <td>{{ $filters.date(tempOrder.create_at) }}</td>\n                  </tr>\n                  <tr>\n                    <th>付款時間</th>\n                    <td>{{ $filters.date(tempOrder.paid_date) }}</td>\n                  </tr>\n                  <tr>\n                    <th>付款狀態</th>\n                    <td>\n                      <span v-if=\"tempOrder.is_paid\" class=\"text-success\">已付款</span>\n                      <span v-else class=\"text-muted\">未付款</span>\n                    </td>\n                  </tr>\n                  <tr>\n                    <th>總金額</th>\n                    <td>{{ $filters.currency(tempOrder.total) }}</td>\n                  </tr>\n                </tbody>\n              </table>\n              <div class=\"fs-4 mb-3 fw-bold\">選購商品</div>\n              <table class=\"table\">\n                <tbody>\n                  <tr v-for=\"item in tempOrder.products\" :key=\"item.id\">\n                    <th>{{ item.product.title }}</th>\n                    <td>{{item.qty}}/{{ item.product.unit }}</td>\n                    <td>{{ $filters.currency(item.total) }}</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-outline-secondary\" data-bs-dismiss=\"modal\">\n            取消\n          </button>\n          <button\n            type=\"button\"\n            class=\"btn btn-primary\"\n            @click=\"$emit('update-order', tempOrder)\"\n          >確認</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport modalMixin from '@/mixins/modalMixins'\nexport default {\n  props: {\n    order: {\n      type: Object,\n      default () { return {} }\n    }\n  },\n  data () {\n    return {\n      modal: {},\n      tempOrder: {},\n      isPaid: false\n    }\n  },\n  watch: {\n    order () {\n      this.tempOrder = this.order\n    }\n  },\n  mixins: [\n    modalMixin\n  ]\n}\n</script>\n","import { render } from \"./OrderModal.vue?vue&type=template&id=4da68e9a\"\nimport script from \"./OrderModal.vue?vue&type=script&lang=js\"\nexport * from \"./OrderModal.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/macintosh/Documents/vue3_2022/diving/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Orders.vue?vue&type=template&id=510eb52a\"\nimport script from \"./Orders.vue?vue&type=script&lang=js\"\nexport * from \"./Orders.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/macintosh/Documents/vue3_2022/diving/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}